<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Nube de Palabras IA</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px; 
            background-color: #f0f0f0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            font-family: sans-serif; 
        }
        #wordcloudContainer { 
            text-align: center; 
            /* Agrupar y centrar las palabras en forma de racimo */
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            max-width: 80%; /* Limitar el ancho para que se agrupe */
        }
        .word { 
            display: inline-block; 
            padding: 3px 6px; 
            margin: 3px; /* Juntar más las palabras */
            border-radius: 5px;
            transition: font-size 0.5s;
            line-height: 1.1; /* Reducir el espacio vertical */
        }
    </style>
</head>
<body>
    <div>
    <h1 style="color: #333; margin-bottom: 30px; font-size: 2.5em;">Nube de Palabras en Vivo: la IA</h1>
    </div>
    
    <div id="wordcloudContainer">
        <p>Cargando datos...</p>
    </div>

    <script>
        // 🚨 CRÍTICO: REEMPLAZAR con su URL de implementación (termina en /exec)
        const DATA_API_URL = 'https://script.google.com/macros/s/AKfycbw7bZwjRHt2H5a9BRpQSDSRQJu1vfVyGt-rNXFPX5WJgb7xQT-AI72pwyRm-TJ306QL/exec'; 

        const colors = ['#007bff', '#28a745', '#dc3545', '#ffc107', '#6f42c1'];

        function fetchAndDrawCloud() {
            // Lógica de fetch a prueba de errores
            fetch(DATA_API_URL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(list => drawWordCloud(list))
                .catch(error => {
                    console.error('Error al obtener datos:', error);
                    document.getElementById('wordcloudContainer').innerHTML = "<p style='color:red;'>🚨 Error: Problema con la cuota de Google o la URL es incorrecta.</p>";
                });
        }

        // Función de dibujo - Corregida para evitar errores de sintaxis
        function drawWordCloud(list) {
            const container = document.getElementById('wordcloudContainer');
            if (!container || !list || list.length === 0) {
                container.innerHTML = "<p>Aún no hay suficientes palabras.</p>";
                return;
            }

            // Cálculo Logarítmico (Solo una declaración de 'const')
            const maxCount = list.reduce((max, [word, count]) => Math.max(max, count), 0);
            
            const logMax = Math.log(maxCount + 1); 
            const minFontSize = 20; 
            const maxFontSize = 100; 
            const range = maxFontSize - minFontSize;

            let htmlContent = '';
            
            list.forEach(([word, count], index) => {
                const fontSize = minFontSize + (Math.log(count + 1) / logMax) * range;
                const color = colors[index % colors.length];

                htmlContent += `<span class="word" style="font-size: ${fontSize}px; color: ${color};">${word}</span>`;
            });

            container.innerHTML = htmlContent;
        }

        window.onload = function() {
            fetchAndDrawCloud(); 
            // 🆕 Intervalo seguro para la cuota de Google
            setInterval(fetchAndDrawCloud, 5000); 
        };
    </script>
</body>
</html>




