<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Nube de Palabras Estables (FRENZY)</title>
    <style>
        body { margin: 0; padding: 20px; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; min-height: 100vh; font-family: sans-serif; }
        #wordcloudContainer { text-align: center; }
        .word { 
            display: inline-block; 
            padding: 5px 8px;
            margin: 5px;
            border-radius: 5px;
            transition: font-size 0.5s;
        }
    </style>
</head>
<body>
    <div id="wordcloudContainer">
        <p>Cargando datos...</p>
    </div>

    <script>
        // 游뚿 REEMPLAZAR con la URL que copi칩. Debe terminar en /exec
        const DATA_API_URL = 'https://script.google.com/macros/s/AKfycbzTgrB0UIG6dS0ivueA_ZK55rDzBrSXSVPiR-MqemHmieBLZQXLsF-B22PnR123SOCm/exec'; 

        // Definir un rango de colores simples
        const colors = ['#007bff', '#28a745', '#dc3545', '#ffc107', '#6f42c1'];

        function fetchAndDrawCloud() {
            fetch(DATA_API_URL)
                .then(response => response.json())
                .then(list => drawWordCloud(list))
                .catch(error => {
                    console.error('Error al obtener datos:', error);
                    document.getElementById('wordcloudContainer').innerHTML = "<p style='color:red;'>Error al cargar la nube.</p>";
                });
        }

        function drawWordCloud(list) {
            const container = document.getElementById('wordcloudContainer');
            if (!container || !list || list.length === 0) {
                container.innerHTML = "<p>A칰n no hay suficientes palabras.</p>";
                return;
            }

            // Encontrar el factor de escalado para el tama침o de fuente
            const maxCount = list.reduce((max, [word, count]) => Math.max(max, count), 0);
            const minFontSize = 20; // Tama침o base para la palabra menos frecuente
            const maxFontSize = 100; // Tama침o m치ximo
            const range = maxFontSize - minFontSize;

            let htmlContent = '';
            
            list.forEach(([word, count], index) => {
                // Calcular el tama침o de fuente usando una escala logar칤tmica para mejor distribuci칩n visual
                const fontSize = minFontSize + (count / maxCount) * range;
                
                // Asignar color rotativo
                const color = colors[index % colors.length];

                htmlContent += `<span class="word" style="font-size: ${fontSize}px; color: ${color};">${word}</span>`;
            });

            container.innerHTML = htmlContent;
        }

        window.onload = function() {
            fetchAndDrawCloud(); // Llamada inicial
            setInterval(fetchAndDrawCloud, 30000); // Mantenemos 30s por seguridad
        };
    </script>
</body>
</html>
